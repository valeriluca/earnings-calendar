<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title style="padding-left: 16px;">
      <p-heading [size]="'large'" [theme]="'dark'">Settings</p-heading>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="p-6 max-w-4xl mx-auto space-y-6">
    
    <!-- Notifications Section -->
    <div class="bg-[#2C2C2E] rounded-lg p-8 shadow-lg">
      <div class="flex items-center gap-3 mb-4">
        <p-icon [name]="'information'" [size]="'medium'" [theme]="'dark'"></p-icon>
        <p-heading [size]="'large'" [theme]="'dark'">Notifications</p-heading>
      </div>
      
      <div class="space-y-4">
        <div class="flex items-center justify-between py-2">
          <p-text [size]="'medium'" [theme]="'dark'">Enable Notifications</p-text>
          <p-switch 
            [checked]="notificationSettings.enabled" 
            (update)="toggleNotifications($event)"
            [theme]="'dark'">
          </p-switch>
        </div>

        <div *ngIf="notificationSettings.enabled" class="pt-2 border-t border-[#3A3A3C]">
          <p-text [size]="'small'" [theme]="'dark'" class="block mb-2 text-[#C9C9CB]" style="padding: 4px 0;">Notification Time</p-text>
          <ion-input
            type="time"
            [value]="notificationSettings.notificationTime"
            (ionChange)="updateNotificationTime($event)"
            class="custom-input">
          </ion-input>
        </div>

        <div *ngIf="notificationSettings.enabled" class="pt-2">
          <p-button 
            expand="full" 
            (click)="testNotification()" 
            [variant]="'secondary'"
            [theme]="'dark'">
            Test Notification
          </p-button>
        </div>
      </div>

      <p-text [size]="'x-small'" [theme]="'dark'" class="block mt-4 text-[#C9C9CB]" style="padding: 4px 0; line-height: 1.6;">
        <strong>Note:</strong> Notifications work best on native apps. Web app notifications have limited support on mobile browsers.
      </p-text>
    </div>

    <!-- Watchlist Section -->
    <div class="bg-[#2C2C2E] rounded-lg p-8 shadow-lg">
      <div class="flex items-center gap-3 mb-4">
        <p-icon [name]="'menu-lines'" [size]="'medium'" [theme]="'dark'"></p-icon>
        <p-heading [size]="'large'" [theme]="'dark'">Stock Watchlist</p-heading>
      </div>

      <!-- Add Stock -->
      <div class="mb-4">
        <p-text [size]="'small'" [theme]="'dark'" class="block mb-2 text-[#C9C9CB]" style="padding: 4px 0;">Add Stock Symbol</p-text>
        <div class="flex gap-2">
          <ion-searchbar
            [(ngModel)]="newSymbol"
            placeholder="Enter stock symbol (e.g., AAPL)"
            (keyup.enter)="addStock()"
            [debounce]="0"
            class="flex-1">
          </ion-searchbar>
          <p-button-pure 
            [icon]="'plus'" 
            (click)="addStock()" 
            [hideLabel]="true"
            [theme]="'dark'">
            Add
          </p-button-pure>
        </div>
      </div>

      <!-- Search Watchlist -->
      <div class="mb-4">
        <ion-searchbar
          [(ngModel)]="searchTerm"
          placeholder="Search watchlist"
          [debounce]="300">
        </ion-searchbar>
      </div>

      <!-- Watchlist Items -->
      <div class="flex flex-wrap gap-2 min-h-[100px] mb-4">
        <p-tag 
          *ngFor="let stock of filteredWatchlist()" 
          [color]="'primary'"
          [theme]="'dark'"
          (click)="removeStock(stock.symbol)"
          class="cursor-pointer">
          {{ stock.symbol }}
        </p-tag>
        
        <div *ngIf="watchlist.length === 0" class="w-full text-center py-8">
          <p-text [size]="'medium'" [theme]="'dark'" class="text-[#C9C9CB]" style="padding: 4px 0;">
            No stocks in watchlist. Add some symbols above!
          </p-text>
        </div>
      </div>

      <p-button 
        expand="full" 
        [variant]="'secondary'"
        (click)="resetWatchlist()"
        [disabled]="watchlist.length === 0"
        [theme]="'dark'">
        Reset to Defaults
      </p-button>

      <p-text [size]="'x-small'" [theme]="'dark'" class="block mt-4 text-[#C9C9CB]" style="padding: 4px 0; line-height: 1.6;">
        Tap the Ã— button on a stock chip to remove it from your watchlist.
      </p-text>
    </div>

    <!-- App Info -->
    <div class="bg-[#2C2C2E] rounded-lg p-8 shadow-lg">
      <p-heading [size]="'large'" [theme]="'dark'" class="mb-4" style="padding: 4px 0;">About</p-heading>
      <div class="space-y-2">
        <p-text [size]="'medium'" [theme]="'dark'" style="padding: 4px 0;"><strong>Earnings Calendar</strong></p-text>
        <p-text [size]="'small'" [theme]="'dark'" class="text-[#C9C9CB]" style="padding: 4px 0;">Version 1.0.0</p-text>
        <p-text [size]="'small'" [theme]="'dark'" class="text-[#C9C9CB]" style="padding: 4px 0;">Built with Ionic + Angular</p-text>
        <p-text [size]="'small'" [theme]="'dark'" class="text-[#C9C9CB]" style="padding: 4px 0;">Data from Financial Modeling Prep API</p-text>
        <p-text [size]="'small'" [theme]="'dark'" class="text-[#C9C9CB]" style="padding: 4px 0;">Design by Porsche Design System</p-text>
      </div>
    </div>

  </div>
</ion-content>
